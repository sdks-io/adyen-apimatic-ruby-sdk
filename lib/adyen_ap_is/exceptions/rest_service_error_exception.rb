# adyen_ap_is
#
# This file was automatically generated by APIMATIC v3.0 (
# https://www.apimatic.io ).

module AdyenApIs
  # RestServiceError class.
  class RestServiceErrorException < APIException
    SKIP = Object.new
    private_constant :SKIP

    # A human-readable explanation specific to this occurrence of the problem.
    # @return [String]
    attr_accessor :detail

    # A code that identifies the problem type.
    # @return [String]
    attr_accessor :error_code

    # A unique URI that identifies the specific occurrence of the problem.
    # @return [String]
    attr_accessor :instance

    # Detailed explanation of each validation error, when applicable.
    # @return [Array[InvalidField]]
    attr_accessor :invalid_fields

    # A unique reference for the request, essentially the same as
    # `pspReference`.
    # @return [String]
    attr_accessor :request_id

    # JSON response payload.
    # @return [Object]
    attr_accessor :response

    # The HTTP status code.
    # @return [Integer]
    attr_accessor :status

    # A short, human-readable summary of the problem type.
    # @return [String]
    attr_accessor :title

    # A URI that identifies the problem type, pointing to human-readable
    # documentation on this problem type.
    # @return [String]
    attr_accessor :type

    # The constructor.
    # @param [String] reason The reason for raising an exception.
    # @param [HttpResponse] response The HttpReponse of the API call.
    def initialize(reason, response)
      super(reason, response)
      hash = APIHelper.json_deserialize(@response.raw_body)
      unbox(hash)
    end

    # Populates this object by extracting properties from a hash.
    # @param [Hash] hash The deserialized response sent by the server in the
    # response body.
    def unbox(hash)
      return nil unless hash

      @detail = hash.key?('detail') ? hash['detail'] : nil
      @error_code = hash.key?('errorCode') ? hash['errorCode'] : nil
      @instance = hash.key?('instance') ? hash['instance'] : SKIP
      # Parameter is an array, so we need to iterate through it
      @invalid_fields = nil
      unless hash['invalidFields'].nil?
        @invalid_fields = []
        hash['invalidFields'].each do |structure|
          @invalid_fields << (InvalidField.from_hash(structure) if structure)
        end
      end

      @invalid_fields = SKIP unless hash.key?('invalidFields')
      @request_id = hash.key?('requestId') ? hash['requestId'] : SKIP
      @response = hash.key?('response') ? hash['response'] : SKIP
      @status = hash.key?('status') ? hash['status'] : nil
      @title = hash.key?('title') ? hash['title'] : nil
      @type = hash.key?('type') ? hash['type'] : nil
    end

    # Provides a human-readable string representation of the object.
    def to_s
      class_name = self.class.name.split('::').last
      "<#{class_name} detail: #{@detail}, error_code: #{@error_code}, instance: #{@instance},"\
      " invalid_fields: #{@invalid_fields}, request_id: #{@request_id}, response: #{@response},"\
      " status: #{@status}, title: #{@title}, type: #{@type}>"
    end

    # Provides a debugging-friendly string with detailed object information.
    def inspect
      class_name = self.class.name.split('::').last
      "<#{class_name} detail: #{@detail.inspect}, error_code: #{@error_code.inspect}, instance:"\
      " #{@instance.inspect}, invalid_fields: #{@invalid_fields.inspect}, request_id:"\
      " #{@request_id.inspect}, response: #{@response.inspect}, status: #{@status.inspect}, title:"\
      " #{@title.inspect}, type: #{@type.inspect}>"
    end
  end
end
